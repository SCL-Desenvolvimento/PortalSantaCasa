<div class="documents-container">
  <div class="documents-content-wrapper">

    <!-- Header Section -->
    <div class="documents-header">
      <h1 class="page-title">
        <i class="fas fa-file-alt"></i>
        Visualizador de Documentos
      </h1>

      <div class="header-actions">
        <a href="/" class="btn-back">
          <i class="fas fa-arrow-left"></i>
          Voltar à Intranet
        </a>
        <button class="btn-list-view" (click)="clearViewer()">
          <i class="fas fa-list"></i>
          Visualização em Lista
        </button>
      </div>
    </div>

    <!-- Breadcrumb -->
    <nav *ngIf="currentDocument" class="breadcrumb-section">
      <div class="breadcrumb">
        <span class="breadcrumb-item" (click)="clearViewer()">
          <i class="fas fa-folder"></i>
          Documentos
        </span>
        <i class="fas fa-chevron-right breadcrumb-separator"></i>
        <span class="breadcrumb-item active">
          <i class="fas fa-file-pdf"></i>
          {{ currentDocument.name }}
        </span>
      </div>
    </nav>

    <!-- Main Layout -->
    <div class="documents-layout">

      <!-- Document Tree Section -->
      <div class="document-tree-section">
        <div class="tree-header">
          <h3 class="tree-title">
            <i class="fas fa-sitemap"></i>
            Estrutura de Documentos
          </h3>
        </div>

        <div class="tree-content">
          <!-- Search Box -->
          <div class="search-box">
            <i class="fas fa-search search-icon"></i>
            <input type="text"
                   class="search-input"
                   placeholder="Pesquisar documentos..."
                   [(ngModel)]="searchQuery"
                   (input)="filterDocuments()" />
          </div>

          <!-- Document Tree -->
          <div class="document-tree" *ngIf="filteredDocuments.length > 0; else noDocuments">
            <ul class="list-unstyled">
              <li *ngFor="let doc of filteredDocuments">
                <app-folder-node [node]="doc"
                                 [allDocuments]="documents"
                                 (documentSelected)="selectDocument($event)">
                </app-folder-node>
              </li>
            </ul>
          </div>

          <!-- No Documents State -->
          <ng-template #noDocuments>
            <div class="no-documents">
              <i class="fas fa-folder-open"></i>
              <p>Nenhum documento encontrado.</p>
            </div>
          </ng-template>
        </div>
      </div>

      <!-- Document Viewer Section -->
      <div class="document-viewer-section">

        <!-- Viewer with Document -->
        <div *ngIf="currentDocument; else noDocumentSelected">
          <div class="viewer-header">
            <div class="document-info">
              <h5>{{ currentDocument.name }}</h5>
              <p class="document-type">Documento PDF</p>
            </div>

            <div class="viewer-actions">
              <button class="action-btn btn-primary" (click)="openFullscreen(currentDocument)">
                <i class="fas fa-expand"></i>
                Tela Cheia
              </button>
              <a [href]="currentDocument.fileUrl" target="_blank" class="action-btn btn-success">
                <i class="fas fa-external-link-alt"></i>
                Nova Aba
              </a>
              <a [href]="currentDocument.fileUrl" download class="action-btn btn-secondary">
                <i class="fas fa-download"></i>
                Download
              </a>
            </div>
          </div>

          <div class="viewer-content">
            <iframe [src]="safeCurrentDocumentUrl" class="document-iframe"></iframe>
          </div>
        </div>

        <!-- No Document Selected State -->
        <ng-template #noDocumentSelected>
          <div class="no-document-selected">
            <i class="fas fa-file-pdf"></i>
            <h3>Selecione um documento</h3>
            <p>Escolha um documento na árvore ao lado para visualizá-lo aqui.</p>
          </div>
        </ng-template>
      </div>
    </div>

  </div>
</div>

<!-- Fullscreen Modal -->
<div class="modal-overlay" *ngIf="fullscreenDocument">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">{{ fullscreenDocument.name }}</h5>
      <button class="modal-close" (click)="closeFullscreen()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="modal-body">
      <iframe [src]="safeFullscreenUrl" class="modal-iframe"></iframe>
    </div>
  </div>
</div>

